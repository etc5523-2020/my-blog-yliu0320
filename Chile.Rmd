---
title: "Chile Coronavirus Statistics"
bibliography: myref.bib
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load-packages,echo=FALSE,message=FALSE,warning=FALSE}
library("tidyverse")
library("plotly")
library("readr")
library("kableExtra")
library("janitor")
library("tibble")
```

Thank the coronavirus repository[@repository] for providing the raw data.

Now I use some essential functions in R to do a brief analysis about Chile coronavirus data.This time I will focus on more plots to help people to have a better data visualisation.

```{r data_citation,echo=FALSE,message=FALSE,warning=FALSE}
coronavirus <- read_csv("coronavirus_updated to 9.11.csv")
coronavirus_Chile <- coronavirus%>%
  filter(country=="Chile")
```


### Overall Data and Trends

In this section,people will have a good understanding of the overall data and trends about the coronavirus in Chile.

The table below shows the cumulative number of infected, deaths and recovered in Chile from 2020.01.22 to 2020.09.11.

<center>
```{r table1,echo=FALSE,message=FALSE,warning=FALSE}
cumulative_confirmed <- coronavirus_Chile%>%
  filter(type == "confirmed")%>%
  summarise(cumulative_confirmed=sum(cases))
cumulative_death <- coronavirus_Chile%>%
  filter(type == "death")%>%
  summarise(cumulative_death=sum(cases))
cumulative_recovered <- coronavirus_Chile%>%
  filter(type == "recovered")%>%
  summarise(cumulative_recovered=sum(cases))
cumulative_case <-tibble(cumulative_confirmed,cumulative_death,cumulative_recovered)%>%
  kable(align="c",caption="Number of infected, deaths and recovered in Chile(from 2020.01.22 to 2020.09.11)") %>% 
  kable_styling()
cumulative_case
```
</center>

People could have a more explicit visualisation from the interactive plot below,which could display the whole data at the same time.

For example,people would find that the daily number of confirmed cases dramatically increased from the middle of May to the beginning of June and the number reached the peak at Jun.6th,which was approximately 13990.The reason for that was South America became the new epicenter of the epidemic and the Chile government lifted some restriction in order to restore economic development.

After that, the daily confirmed cases sharply decreased and finally stabilized at nearly 2000 because the scope of mandatory isolation was expanded and more strict measures were implemented.

Besides,people could notice the daily recovered cases on June 2 was so high and it rose to 41227,which value was nearly 19 times as many as that on June 1.Maybe it has something to do with the change of definition of active cases by the Ministry of Health[@pandemic].

<center>
```{r plot1,echo=FALSE,message=FALSE,warning=FALSE}
coronavirus_Chile%>%
  group_by(date,type)%>%
  summarise(total=sum(cases))%>%
  pivot_wider(names_from=type,values_from=total)%>%
  plot_ly(x = ~ date,
           y = ~ confirmed,
           type = "scatter",
           name="Confirmed",
           fillcolor="blue",
           alpha=0.5)%>%
  add_trace(y = ~ death, 
            name = "Death",
            fillcolor = "red") %>%
  add_trace(y = ~recovered, 
            name = "Recovered", 
            fillcolor = "green") %>%
  layout(title = "Distribution of Covid19 Cases in Chile",
         legend = list(x = 0.1, y = 0.9),
         yaxis = list(title = "Number of Cases"))
```
</center>

### Different Region Data

In this section,the plot below displays a detailed data information about the total confirmed number by region.People would find the coronavirus confirmed number fits with the population density. :)

From the data of population density in Chile[@density],people could surprisingly notice that the population density in Metropolitan region,where the capital city of Santiago is located,reaches 462 people per square kilometer.It is almost 20 times as many as the average population density of this country,which value is 24 people per square kilometer.

So the plot below demonstrates this feature.The most affected area is the Metropolitan region.As of 2020.09.08,the number of confirmed cases of coronavirus reached 278,241[@region] in the Metropolitan region, which accounted for over 65 percent of the total cases registered in Chile.At the same time,because of the harsh geographical environment like Atacama Desert,region like Atacama has the low population density(almost 3.8 people per square kilometer).The number of confirmed cases in this place was low.

Therefore,it is obvious that the population density is an important factor to determine the scope of coronaviruse transmission to some extent.So appropriate social distance is an effective way to prevent the spread of coronavirus.

<center>
```{r plot2,echo=FALSE,message=FALSE,warning=FALSE}
confirmed_region <- tribble(~"Metropolitana(Santiago)",~"Valparaíso",~"Biobío",~"Antofagasta",~"O’Higgins",~"Maule",~"Tarapacá",~"Coquimbo",~"Los Lagos",~"Arica y Parinacota",~"Atacama",~"Araucanía",~"Ñuble",~"Magallanes",~"Los Ríos",~"Aysén",~"Unknown",                           "278241","24438","19390","18792","14247","12770","11021","10714","7225","7101","6082","5595","5229","4738","1253","136","55")

confirmed_region <-confirmed_region%>%
  pivot_longer(cols="Metropolitana(Santiago)":"Unknown",
               names_to="region",
               values_to="cases")%>%
  mutate(cases=as.numeric(cases))%>%
  arrange(cases)

ggplot(confirmed_region,
       aes(x=reorder(region,cases),y=cases,fill=region))+
  geom_bar(stat = "identity",width =0.8,show.legend = FALSE)+
  scale_fill_manual(values=c("grey50", "grey50", "grey50", "grey50","grey50","grey50","grey50","grey50","grey50","grey50","grey50","red","grey50","grey50","grey50","grey50","grey50"))+
  labs(title="Number of confirmed cases of Covid19 in Chile by region(from 2020.01.22 to 2020.09.08)",x = NULL, y = NULL,caption = "SOURCE: Statista 2020")+
  theme(axis.ticks = element_blank(), 
        axis.text.x = element_blank(),
        plot.title = element_text(size=9.5),
        plot.caption= element_text(size=8))+
  geom_text(aes(label=cases),hjust = -0.008, size = 2)+
  coord_flip()
```
</center>

*  *  *  *
References